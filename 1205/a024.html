<!DOCTYPE html>
<html>
    <script>
        let hint1 = ["平行四邊形面積，先找出底、高", "先計算出面積，再進行比較"];
        function initial(){
            // let question_one = document.getElementById("question_one").innerHTML = ``;
            problem_one_picture();
            problem_two_picture();
            problem_three_one_picture();

        }
        function problem_one_picture(){
            let canvas = document.getElementById("myCanvas1");
            let print = canvas.getContext("2d");

            // test
            // 3, 2 10, 2 10, 4 3, 4 3, 2
            print.beginPath();
            print.lineWidth = 5;
            print.moveTo(3 * 25, 2 * 25);
            print.lineTo(10 * 25, 2 * 25);
            print.lineTo(8 * 25, 4 * 25);
            print.lineTo(1 * 25, 4 * 25);
            print.lineTo(3 * 25, 2 * 25);
            // print.lineTo(4 * 25, 3 * 25);
            // print.lineTo(3 * 25, 2 * 25);
            print.strokeStyle = "#8600FF";
            print.stroke();
            
            print.fillStyle = "#FFD0FF";
            print.fill();
            print.lineWidth = 1;
            // Grid lines
            print.strokeStyle = "#cccccc";
            for (let i = 25; i <= 400; i += 25) {
                print.beginPath();
                print.moveTo(i, 50);
                print.lineTo(i, 150);
                print.stroke();
            }
            for (let j = 50; j <= 150; j += 25) {
                print.beginPath();
                print.moveTo(25, j);
                print.lineTo(400, j);
                print.stroke();
            }
            print.fillStyle = "#000000";
            print.font = "16px Arial";
            print.fillText("1 cm", 16 * 25 + 12.5, 6 * 25 - 5);
            print.fillText("1 cm", 15 * 25, 7 * 25);
            // Draw brackets
            print.beginPath();
            print.arc(16 * 25, 6 * 25 - 12.5, 10, 1.5 * Math.PI, 0.5 * Math.PI); // Right bracket
            print.strokeStyle = "#000000";
            print.stroke();

            print.beginPath();
            print.arc(16 * 25 - 12.5, 6 * 25 - 12.5 + 12.5, 10, 0, Math.PI); // Upward arc
            print.strokeStyle = "#000000";
            print.stroke();
        }
        function problem_two_picture(){
            let canvas = document.getElementById("myCanvas2");
            let print = canvas.getContext("2d");

            // test
            // 1, 2 5, 2 7, 4 3, 4 1, 2
            print.beginPath();
            print.lineWidth = 5;
            print.moveTo(1 * 25, 2 * 25);
            print.lineTo(5 * 25, 2 * 25);
            print.lineTo(7 * 25, 5 * 25);
            print.lineTo(3 * 25, 5 * 25);
            print.lineTo(1 * 25, 2 * 25);
            // print.lineTo(4 * 25, 3 * 25);
            // print.lineTo(3 * 25, 2 * 25);
            print.strokeStyle = "#8600FF";
            print.stroke();
            
            print.fillStyle = "#FFD0FF";
            print.fill();
            print.lineWidth = 1;
            // Grid lines
            print.strokeStyle = "#cccccc";
            for (let i = 25; i <= 400; i += 25) {
                print.beginPath();
                print.moveTo(i, 50);
                print.lineTo(i, 150);
                print.stroke();
            }
            for (let j = 50; j <= 150; j += 25) {
                print.beginPath();
                print.moveTo(25, j);
                print.lineTo(400, j);
                print.stroke();
            }
            print.fillStyle = "#000000";
            print.font = "16px Arial";
            print.fillText("1 cm", 16 * 25 + 12.5, 6 * 25 - 5);
            print.fillText("1 cm", 15 * 25, 7 * 25);
            // Draw brackets
            print.beginPath();
            print.arc(16 * 25, 6 * 25 - 12.5, 10, 1.5 * Math.PI, 0.5 * Math.PI); // Right bracket
            print.strokeStyle = "#000000";
            print.stroke();

            print.beginPath();
            print.arc(16 * 25 - 12.5, 6 * 25 - 12.5 + 12.5, 10, 0, Math.PI); // Upward arc
            print.strokeStyle = "#000000";
            print.stroke();
        }
        function problem_three_one_picture(){
            let canvas = document.getElementById("myCanvas3_1");
            let print = canvas.getContext("2d");

            // draw first picture
            print.beginPath();
            print.lineWidth = 3;
            print.moveTo(1 * 15, 2 * 15);
            print.lineTo(9 * 15, 2 * 15);
            print.lineTo(10 * 15, 3 * 15);
            print.lineTo(2 * 15, 3 * 15);
            print.lineTo(1 * 15, 2 * 15);
            print.strokeStyle = "#8600FF";
            print.stroke();
            print.fillStyle = "#FFD0FF";
            print.fill();

            print.fillStyle = "#FFD0FF";
            print.font = "16px Arial";
            print.fillText("A", 1 * 15 - 7, 2 * 15 - 7);
            print.fillText("B", 13 * 15 + 5 - 7, 2 * 15 - 7);
            print.fillText("C", 25 * 15 + 3 + 5 - 7, 2 * 15 - 7);
            // draw second picture
            print.beginPath();
            print.lineWidth = 3;
            print.moveTo(14 * 15 + 5, 1 * 15);
            print.lineTo(17 * 15 + 5, 1 * 15);
            print.lineTo(22 * 15 + 5, 5 * 15);
            print.lineTo(19 * 15 + 5, 5 * 15);
            print.lineTo(14 * 15 + 5, 1 * 15);
            print.strokeStyle = "#8600FF";
            print.stroke();
            print.fillStyle = "#FFD0FF";
            print.fill();
            
            // draw third picture
            print.beginPath();
            print.lineWidth = 3;
            print.moveTo(30 * 15 + 10, 1 * 15);
            print.lineTo(30 * 15 + 10, 4 * 15);
            print.lineTo(26 * 15 + 10, 6 * 15);
            print.lineTo(26 * 15 + 10, 3 * 15);
            print.lineTo(30 * 15 + 10, 1 * 15);
            // print.lineTo(17 * 15 + 5, 1 * 15);
            // print.lineTo(22 * 15 + 5, 5 * 15);
            // print.lineTo(19 * 15 + 5, 5 *15);
            print.strokeStyle = "#8600FF";
            print.stroke();
            print.fillStyle = "#FFD0FF";
            print.fill();

            print.lineWidth = 1;
            // Grid lines
            print.strokeStyle = "#cccccc";
            // 15, 150 15, 100
            for (let i = 15; i <= 150; i += 15) {
                print.beginPath();
                print.moveTo(i, 15);
                print.lineTo(i, 90);
                print.stroke();
            }
            for (let j = 15; j <= 100; j += 15) {
                print.beginPath();
                print.moveTo(15, j);
                print.lineTo(150, j);
                print.stroke();
            }
            // 200, 235 200, 185
            for (let i = 200; i <= (200 + 150 - 15); i += 15) {
                print.beginPath();
                print.moveTo(i, 15);
                print.lineTo(i, 90);
                print.stroke();
            }
            for (let j = 15; j <= 100; j += 15) {
                print.beginPath();
                print.moveTo(200, j);
                print.lineTo((200 + 150 - 15), j);
                print.stroke();
            }
            // the three picture
            for (let i = 385; i <= (385 + 150 - 15); i += 15) {
                print.beginPath();
                print.moveTo(i, 15);
                print.lineTo(i, 90);
                print.stroke();
            }
            for (let j = 15; j <= 100; j += 15) {
                print.beginPath();
                print.moveTo(385, j);
                print.lineTo((385 + 150 - 15), j);
                print.stroke();
            }
            // for (let j = 200; j <= 100; j += 15) {
            //     print.beginPath();
            //     print.moveTo(15, j);
            //     print.lineTo(150, j);
            //     print.stroke();
            // }
            print.fillStyle = "#000000";
            print.font = "16px Arial";
            
            
            print.fillText("1 cm", 15 * 25, 7 * 25);
            // Draw brackets
            print.beginPath();
            print.arc(16 * 25, 6 * 25 - 12.5, 10, 1.5 * Math.PI, 0.5 * Math.PI); // Right bracket
            print.strokeStyle = "#000000";
            print.stroke();

            print.beginPath();
            print.arc(16 * 25 - 12.5, 6 * 25 - 12.5 + 12.5, 10, 0, Math.PI); // Upward arc
            print.strokeStyle = "#000000";
            print.stroke();
        }
        let check_yes_ro_no = ["correct!!!", "error!!!"];
        function correct_problem_one(){
            // let button_one = document.getElementById("button_one");
            // button_one.disabled = true;
            // Get all radio buttons for the first question
            let options = document.getElementsByName("p1");
            
            // Find the selected radio button
            let selectedAnswer;
            for (let i = 0; i < options.length; i++) {
                if (options[i].checked) {
                    selectedAnswer = options[i].value;
                    break;
                }
            }
            
            // Define the correct answer
            let correctAnswer = "14"; // Assuming the correct answer is 14 based on your question
            let feedback_one = document.getElementById("feedback_one");
            // Check if the selected answer is correct
            if (selectedAnswer === correctAnswer) {
                // alert("Correct answer!");
                correct_music_show();
                feedback_one.innerHTML = `correct!!!`;
                let button_one = document.getElementById("button_one");
                button_one.disabled = true;
            } else {
                error_music_show();
                feedback_one.innerHTML = `error!!!`;
                document.getElementById("hint_one").innerHTML = `提示:${hint1[0]}`;
                // alert("Incorrect answer. The correct answer is " + correctAnswer);
            }
        }
        function correct_problem_two(){
            // let button_two = document.getElementById("button_two");
            // button_two.disabled = true;
            let user_answer_two = document.getElementById("user_answer_two").value;
            let the_correct_answer = "12";
            let feedback_two = document.getElementById("feedback_two");
            if(user_answer_two === the_correct_answer){
                correct_music_show();
                feedback_two.innerHTML = `${check_yes_ro_no[0]}`;
                let button_two = document.getElementById("button_two");
                button_two.disabled = true;
            }
            else{
                error_music_show();
                document.getElementById("hint_two").innerHTML = `提示:${hint1[0]}`;
                feedback_two.innerHTML = `${check_yes_ro_no[1]}`;
            }
        }
        function correct_problem_three() {
            // let button_three = document.getElementById("button_three");
            // button_three.disabled = true; // 禁用按鈕

            // 獲取使用者選擇的值
            let user_selected = Array.from(document.getElementById("user_answer_three").selectedOptions)
                                    .map(option => option.value);

            // 正確答案
            let correct_answers = ["B", "C"];
            
            // 判斷是否有選擇
            if (user_selected.length === 0) {
                alert("請選擇至少一個選項！");
                button_three.disabled = false; // 恢復按鈕可用性
                return;
            }

            // 判斷對錯
            let feedback = document.getElementById("feedback_three");
            if (user_selected.sort().join(",") === correct_answers.sort().join(",")) {
                let button_three = document.getElementById("button_three");
                button_three.disabled = true; // 禁用按鈕
                feedback.innerHTML = `${check_yes_ro_no[0]}`;
                correct_music_show();
            } else {
                document.getElementById("hint_three").innerHTML = `提示:${hint1[1]}`;
                feedback.innerHTML = `${check_yes_ro_no[1]}`;
                error_music_show();
                        }
        }

        // 定義正確答案的對應映射
        const correctAnswers = {
            "question_one": ["A", "C"],
            "question_two": ["B"]
        };

        function correct_one(questionId) {
            // console.log("123");
            // 獲取該題的所有選項
            let questionOptions = document.querySelectorAll(`#${questionId} input[type="checkbox"]`);
            // alert(questionId);
            // 獲取選中的選項
            let selectedOptions = Array.from(questionOptions)
                .filter(option => option.checked)
                .map(option => option.value);

            // 獲取回饋區域
            let feedbackElement = document.querySelector(`#${questionId} .feedback`);

            // 獲取該題的按鈕
            let buttonElement = document.querySelector(`#${questionId} button`);

            // 判斷是否有選擇
            if (selectedOptions.length === 0) {
                feedbackElement.innerHTML = "請至少選擇一個選項！";
                return;
            }

            // 比對正確答案
            let correct = correctAnswers[questionId].sort().join(",") === selectedOptions.sort().join(",");
            feedbackElement.innerHTML = correct ? "答對了！" : "答錯了，請再試一次！";

            // 如果答對，禁用按鈕
            if (correct) {
                correct_music_show();
                buttonElement.disabled = true;
            }
            if(!correct){
                error_music_show();
                if(questionId === "question_one"){
                    document.getElementById("hint_four").innerHTML = `提示:${hint1[1]}`;
                    
                }
                if(questionId === "question_two"){
                    document.getElementById("hint_five").innerHTML = `提示:${hint1[1]}`;
                }
            }
        }
        function correct_music_show(){
            let correct_sound = document.getElementById("correct_sound");
            correct_sound.play();
        }
        function error_music_show(){
            let error_sound = document.getElementById("error_sound");
            error_sound.play();
        }

    </script>
    <head>
        <!-- <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"> -->
        <!-- Bootstrap JavaScript Bundle with Popper -->
        <!-- <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script> -->

    </head>
    <body onload = "initial();">
        <audio id = "correct_sound" src = "correct.mp3"></audio>
        <audio id = "error_sound" src = "error.mp3"></audio>
        <h1>平行四邊形面積測驗</h1>
        <button style="float: right;" class="btn btn-primary" onclick = "window.location.href = 'a013.html'">返回主選單</button>
        
        <hr />
        <!-- <input type = "checkbox" value = "10">10
        <input type = "checkbox" value = "20">20 -->
        <span>註:每個格子邊長為1cm</span>
        <table border="3">
            <tr style="text-align: center; vertical-align: middle;">
                <td style = "width : 20%;">第一題</td>
                <td style = "width : 80%;">
                    <!-- <span id = "question_one"></span> -->
                    <span>下列平行四邊形的面積為多少?</span><br>
                    <canvas id="myCanvas1" width="500" height="200" style="border:1px solid #000;"></canvas><br>
                    <input type = "radio" name = "p1" value = "7">7 &nbsp;
                    <input type = "radio" name = "p1" value = "14">14 &nbsp;
                    <input type = "radio" name = "p1" value = "21">21 &nbsp;
                    <button id = "button_one" onclick = "correct_problem_one();">確認</button> &nbsp;
                    
                    <span id = "feedback_one"></span><br>
                    <span style = "color: red;" id = "hint_one"></span>
                </td>
            </tr>
            <tr style="text-align: center; vertical-align: middle;">
                <td style = "width : 20%;">第二題</td>
                <td style = "width : 80%;">
                    <!-- <span id = "question_two"></span> -->
                    <span>下列平行四邊形的面積為多少?</span><br>
                    <canvas id="myCanvas2" width="500" height="200" style="border:1px solid #000;"></canvas><br>
                    <textarea id = "user_answer_two" placeholder = "輸入平行四邊形面積(只需輸入數字)"></textarea>
                    <button id = "button_two" onclick = "correct_problem_two();">確定</button> &nbsp;
                    <span id = "feedback_two"></span><br>
                    <span style = "color: red;" id = "hint_two"></span>
                </td>
            </tr>
            <tr style="text-align: center; vertical-align: middle;">
                <td style = "width : 20%;">第三題</td>
                <td style = "width : 80%;">
                    <!-- <span id = "question_two"></span> -->
                    <span>下列哪些圖形面積為12cm^2?</span><br>
                    <canvas id="myCanvas3_1" width="640" height="100" style="border:1px solid #000; float : left;"></canvas><br>
                    <!-- <canvas id="myCanvas3_2" width="160" height="100" style="border:1px solid #000; float : middle;"></canvas><br>
                    <canvas id="myCanvas3_3" width="500" height="200" style="border:1px solid #000;"></canvas><br> -->
                    <br>
                    <select id="user_answer_three" multiple size="3">
                        <option value="A">A</option>
                        <option value="B">B</option>
                        <option value="C">C</option>
                    </select>
                    <button id="button_three" onclick="correct_problem_three();">確定</button>
                    <span id="feedback_three"></span><br>
                    <span style = "color: red;" id = "hint_three"></span>
                </td>
            </tr>
            <tr style="text-align: center; vertical-align: middle;">
                <td style="width: 20%;">第四題</td>
                <td style="width: 80%;" id="question_one">
                    <span>下列哪些底與高所構成的平行四邊形面積相同?</span><br>
                    <label><input type="checkbox" value="A">底 : 5cm, 高 : 6cm</label><br>
                    <label><input type="checkbox" value="B">底 : 19cm, 高 : 2cm</label><br>
                    <label><input type="checkbox" value="C">底 : 1cm, 高 : 30cm</label><br>
                    <button onclick="correct_one('question_one');">確定</button>
                    <span class="feedback"></span><br>
                    <span style = "color: red;" id = "hint_four"></span>
                </td>
            </tr>
            <tr style="text-align: center; vertical-align: middle;">
                <td style="width: 20%;">第五題</td>
                <td style="width: 80%;" id="question_two">
                    <span>有一個平行四邊形的圖形，底為5cm，高為9cm，請問此平行四邊形的面積為多少?</span><br>
                    <label><input type="checkbox" value="A">35cm^2</label><br>
                    <label><input type="checkbox" value="B">45cm^2</label><br>
                    <label><input type="checkbox" value="C">55cm^2</label><br>
                    <button onclick="correct_one('question_two');">確定</button>
                    <span class="feedback"></span><br>
                    <span style = "color: red;" id = "hint_five"></span>
                </td>
            </tr>
        </table>
    </body>
</html>